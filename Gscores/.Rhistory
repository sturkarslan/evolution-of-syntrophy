#DvH
mut.data.dv <- read.delim("/Volumes/omics4tb/sturkarslan/syntrophy_raw_sequences/dvh_mutations_allsamples_attributes_5152019.txt", header=T, sep="\t",)
mut.data.dv$organism <- "Desulfovibrio"
length(mut.data.dv$variant_id) # 3873
length(unique(mut.data.dv$variant_id)) # 304
table(mut.data.dv$effect)
plot(table(mut.data.dv$effect))
plot(table(mut.data.dv$effect))
plot(table(mut.data.dv$mutation))
plot(order(table(mut.data.dv$mutation)))
melt(table(mut.data.dv$mutation))
library('ggplot2'); library('reshape2');library(gridExtra);library(gplots)
source("~/Google Drive File Stream/My Drive/R_Scripts/extractLegend.R")
melt(table(mut.data.dv$mutation))
#DvH
mut.data.dv <- read.delim("/Volumes/omics4tb/sturkarslan/syntrophy_raw_sequences/dvh_mutations_allsamples_attributes_5152019.txt", header=T, sep="\t",)
mut.data.dv$organism <- "Desulfovibrio"
#length(mut.data.dv$variant_id) # 3873
#length(unique(mut.data.dv$variant_id)) # 304
mut.type <- melt(table(mut.data.dv$mutation))
p1 <- ggplot(mut.type, aes(Var1, value, fill=Var1))
p1 + geom_bar()
#DvH
mut.data.dv <- read.delim("/Volumes/omics4tb/sturkarslan/syntrophy_raw_sequences/dvh_mutations_allsamples_attributes_5152019.txt", header=T, sep="\t",)
mut.data.dv$organism <- "Desulfovibrio"
#length(mut.data.dv$variant_id) # 3873
#length(unique(mut.data.dv$variant_id)) # 304
mut.type <- melt(table(mut.data.dv$mutation))
p1 <- ggplot(mut.type, aes(Var1, value, fill=Var1))
p1 + geom_bar(stat="identity")
#DvH
mut.data.dv <- read.delim("/Volumes/omics4tb/sturkarslan/syntrophy_raw_sequences/dvh_mutations_allsamples_attributes_5152019.txt", header=T, sep="\t",)
mut.data.dv$organism <- "Desulfovibrio"
#length(mut.data.dv$variant_id) # 3873
#length(unique(mut.data.dv$variant_id)) # 304
mut.type <- melt(table(mut.data.dv$mutation))
p1 <- ggplot(mut.type, aes(factor(Var1, levels = mut.type[order(mut.type$value, decreasing = T),"Var1"]), value, fill=Var1))
p1 + geom_bar(stat="identity")
#DvH
mut.data.dv <- read.delim("/Volumes/omics4tb/sturkarslan/syntrophy_raw_sequences/dvh_mutations_allsamples_attributes_5152019.txt", header=T, sep="\t",)
mut.data.dv$organism <- "Desulfovibrio"
#length(mut.data.dv$variant_id) # 3873
#length(unique(mut.data.dv$variant_id)) # 304
mut.type <- melt(table(mut.data.dv$mutation))
p1 <- ggplot(mut.type, aes(factor(Var1, levels = mut.type[order(mut.type$value, decreasing = T),"Var1"]), value, fill=Var1))
p1 + geom_bar(stat="identity")
p1 + geom_label(aes(Var1))
#DvH
mut.data.dv <- read.delim("/Volumes/omics4tb/sturkarslan/syntrophy_raw_sequences/dvh_mutations_allsamples_attributes_5152019.txt", header=T, sep="\t",)
mut.data.dv$organism <- "Desulfovibrio"
#length(mut.data.dv$variant_id) # 3873
#length(unique(mut.data.dv$variant_id)) # 304
mut.type <- melt(table(mut.data.dv$mutation))
p1 <- ggplot(mut.type, aes(factor(Var1, levels = mut.type[order(mut.type$value, decreasing = T),"Var1"]), value, fill=Var1))
p1 + geom_bar(stat="identity")
p1 + geom_label(aes(label=Var1))
#DvH
mut.data.dv <- read.delim("/Volumes/omics4tb/sturkarslan/syntrophy_raw_sequences/dvh_mutations_allsamples_attributes_5152019.txt", header=T, sep="\t",)
mut.data.dv$organism <- "Desulfovibrio"
#length(mut.data.dv$variant_id) # 3873
#length(unique(mut.data.dv$variant_id)) # 304
mut.type <- melt(table(mut.data.dv$mutation))
p1 <- ggplot(mut.type, aes(factor(Var1, levels = mut.type[order(mut.type$value, decreasing = T),"Var1"]), value, fill=Var1))
p1 + geom_bar(stat="identity") + geom_label(aes(label=value))
#DvH
mut.data.dv <- read.delim("/Volumes/omics4tb/sturkarslan/syntrophy_raw_sequences/dvh_mutations_allsamples_attributes_5152019.txt", header=T, sep="\t",)
mut.data.dv$organism <- "Desulfovibrio"
#length(mut.data.dv$variant_id) # 3873
#length(unique(mut.data.dv$variant_id)) # 304
mut.type <- melt(table(mut.data.dv$mutation))
p1 <- ggplot(mut.type, aes(factor(Var1, levels = mut.type[order(mut.type$value, decreasing = T),"Var1"]), value, fill=Var1))
p1 + geom_bar(stat="identity") + geom_label(aes(label=value)) +
p1 <- p1 + theme(axis.text.x = element_blank())
#DvH
mut.data.dv <- read.delim("/Volumes/omics4tb/sturkarslan/syntrophy_raw_sequences/dvh_mutations_allsamples_attributes_5152019.txt", header=T, sep="\t",)
mut.data.dv$organism <- "Desulfovibrio"
#length(mut.data.dv$variant_id) # 3873
#length(unique(mut.data.dv$variant_id)) # 304
mut.type <- melt(table(mut.data.dv$mutation))
p1 <- ggplot(mut.type, aes(factor(Var1, levels = mut.type[order(mut.type$value, decreasing = T),"Var1"]), value, fill=Var1))
p1 + geom_bar(stat="identity") + geom_label(aes(label=value))
p1 <- p1 + theme(axis.text.x = element_blank())
#DvH
mut.data.dv <- read.delim("/Volumes/omics4tb/sturkarslan/syntrophy_raw_sequences/dvh_mutations_allsamples_attributes_5152019.txt", header=T, sep="\t",)
mut.data.dv$organism <- "Desulfovibrio"
#length(mut.data.dv$variant_id) # 3873
#length(unique(mut.data.dv$variant_id)) # 304
mut.type <- melt(table(mut.data.dv$mutation))
p1 <- ggplot(mut.type, aes(factor(Var1, levels = mut.type[order(mut.type$value, decreasing = T),"Var1"]), value, fill=Var1))
p1 + geom_bar(stat="identity") + geom_label(aes(label=value))
p1 <- p1 + theme(axis.text = element_blank())
#DvH
mut.data.dv <- read.delim("/Volumes/omics4tb/sturkarslan/syntrophy_raw_sequences/dvh_mutations_allsamples_attributes_5152019.txt", header=T, sep="\t",)
mut.data.dv$organism <- "Desulfovibrio"
#length(mut.data.dv$variant_id) # 3873
#length(unique(mut.data.dv$variant_id)) # 304
mut.type <- melt(table(mut.data.dv$mutation))
p1 <- ggplot(mut.type, aes(factor(Var1, levels = mut.type[order(mut.type$value, decreasing = T),"Var1"]), value, fill=Var1))
p1 <- p1 + geom_bar(stat="identity")
p1 <- p1 + geom_label(aes(label=value))
p1 <- p1 + theme(axis.text = element_blank())
#DvH
mut.data.dv <- read.delim("/Volumes/omics4tb/sturkarslan/syntrophy_raw_sequences/dvh_mutations_allsamples_attributes_5152019.txt", header=T, sep="\t",)
mut.data.dv$organism <- "Desulfovibrio"
#length(mut.data.dv$variant_id) # 3873
#length(unique(mut.data.dv$variant_id)) # 304
mut.type <- melt(table(mut.data.dv$mutation))
p1 <- ggplot(mut.type, aes(factor(Var1, levels = mut.type[order(mut.type$value, decreasing = T),"Var1"]), value, fill=Var1))
p1 <- p1 + geom_bar(stat="identity")
p1 <- p1 + geom_label(aes(label=value))
p1 <- p1 + theme(axis.text = element_blank())
p1
#DvH
mut.data.dv <- read.delim("/Volumes/omics4tb/sturkarslan/syntrophy_raw_sequences/dvh_mutations_allsamples_attributes_5152019.txt", header=T, sep="\t",)
mut.data.dv$organism <- "Desulfovibrio"
#length(mut.data.dv$variant_id) # 3873
#length(unique(mut.data.dv$variant_id)) # 304
mut.type <- melt(table(mut.data.dv$mutation))
p1 <- ggplot(mut.type, aes(factor(mutations=Var1, levels = mut.type[order(mut.type$value, decreasing = T),"Var1"]), value, fill=Var1))
p1 <- p1 + geom_bar(stat="identity")
p1 <- p1 + geom_label(aes(label=value))
p1 <- p1 + theme(axis.text = element_blank())
p1
#DvH
mut.data.dv <- read.delim("/Volumes/omics4tb/sturkarslan/syntrophy_raw_sequences/dvh_mutations_allsamples_attributes_5152019.txt", header=T, sep="\t",)
mut.data.dv$organism <- "Desulfovibrio"
#length(mut.data.dv$variant_id) # 3873
#length(unique(mut.data.dv$variant_id)) # 304
mut.type <- melt(table(mut.data.dv$mutation))
p1 <- ggplot(mut.type, aes(factor(Var1, levels = mut.type[order(mut.type$value, decreasing = T),"Var1"]), value, fill=Var1))
p1 <- p1 + geom_bar(stat="identity")
p1 <- p1 + geom_label(aes(label=value))
p1 <- p1 + theme(axis.text = element_blank(), axis.title.x = "Mutations", axis.title.y = "Count", legend.title = "Mutations")
#DvH
mut.data.dv <- read.delim("/Volumes/omics4tb/sturkarslan/syntrophy_raw_sequences/dvh_mutations_allsamples_attributes_5152019.txt", header=T, sep="\t",)
mut.data.dv$organism <- "Desulfovibrio"
#length(mut.data.dv$variant_id) # 3873
#length(unique(mut.data.dv$variant_id)) # 304
mut.type <- melt(table(mut.data.dv$mutation))
p1 <- ggplot(mut.type, aes(factor(Var1, levels = mut.type[order(mut.type$value, decreasing = T),"Var1"]), value, fill=Var1))
p1 <- p1 + geom_bar(stat="identity")
p1 <- p1 + geom_label(aes(label=value))
p1 <- p1 + theme(axis.text = element_blank(),  legend.title = "Mutations")
#DvH
mut.data.dv <- read.delim("/Volumes/omics4tb/sturkarslan/syntrophy_raw_sequences/dvh_mutations_allsamples_attributes_5152019.txt", header=T, sep="\t",)
mut.data.dv$organism <- "Desulfovibrio"
#length(mut.data.dv$variant_id) # 3873
#length(unique(mut.data.dv$variant_id)) # 304
mut.type <- melt(table(mut.data.dv$mutation))
p1 <- ggplot(mut.type, aes(factor(Var1, levels = mut.type[order(mut.type$value, decreasing = T),"Var1"]), value, fill=Var1))
p1 <- p1 + geom_bar(stat="identity")
p1 <- p1 + geom_label(aes(label=value))
p1 <- p1 + theme(axis.text = element_blank(), legend.title = element_text("Mutations"))
p1 <- p1 + labs(x = "Mutations", y = "Count")
p1
#DvH
mut.data.dv <- read.delim("/Volumes/omics4tb/sturkarslan/syntrophy_raw_sequences/dvh_mutations_allsamples_attributes_5152019.txt", header=T, sep="\t",)
mut.data.dv$organism <- "Desulfovibrio"
#length(mut.data.dv$variant_id) # 3873
#length(unique(mut.data.dv$variant_id)) # 304
mut.type <- melt(table(mut.data.dv$mutation))
p1 <- ggplot(mut.type, aes(factor(Var1, levels = mut.type[order(mut.type$value, decreasing = T),"Var1"]), value, fill=Var1))
p1 <- p1 + geom_bar(stat="identity")
p1 <- p1 + geom_label(aes(label=value))
p1 <- p1 + theme(axis.text = element_blank())
p1 <- p1 + labs(x = "Mutations", y = "Count")
p1
mut.effect <- melt(table(mut.data.dv$effect))
p2 <- ggplot(mut.effect, aes(factor(Var1, levels = mut.effect[order(mut.effect$value, decreasing = T),"Var1"]), value, fill=Var1))
p2 <- p2 + geom_bar(stat="identity")
p2 <- p2 + geom_label(aes(label=value))
p2 <- p2 + theme(axis.text = element_blank())
p2 <- p2 + labs(x = "Effect", y = "Count")
p2
